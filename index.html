<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è·¨å¹´é‚€è¯·</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 1;
            transition: opacity 0.3s ease;
        }
        
        .modal.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            max-width: 500px;
            width: 80%;
            text-align: center;
            transform: scale(1);
            transition: transform 0.3s ease;
        }
        
        .modal.hidden .modal-content {
            transform: scale(0.9);
        }
        
        h2 {
            color: #333;
            margin-bottom: 20px;
            min-height: 1.5em;
            font-size: 1.5em;
        }
        
        .options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }
        
        .option-btn {
            padding: 12px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s, transform 0.2s;
        }
        
        .option-btn:hover {
            background-color: #45a049;
            transform: translateY(-2px);
        }
        
        .hidden {
            display: none;
        }
        
        /* é€å­—æ˜¾ç¤ºæ•ˆæœ */
        .typewriter {
            overflow: hidden;
            white-space: nowrap;
            margin: 0 auto;
        }
        
        .cursor::after {
            content: '|';
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        
        /* æ–‡å­—ç‰¹æ•ˆ */
        .glow {
            text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px #ff4da6, 0 0 20px #ff4da6;
            color: #ff0066;
        }
        
        .bounce {
            display: inline-block;
            animation: bounce 0.5s;
        }
        
        @keyframes bounce {
            0%, 20%, 60%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            80% {
                transform: translateY(-5px);
            }
        }
        
        .pulse {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
            }
        }
        
        .rainbow {
            background: linear-gradient(to right, #ff0066, #ff9900, #33cc33, #3399ff, #cc33ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: rainbow 3s infinite;
        }
        
        @keyframes rainbow {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- éŸ³ä¹é€‰æ‹©å¼¹çª— -->
    <div id="musicModal" class="modal">
        <div class="modal-content">
            <h2>è¯·é€‰æ‹©éŸ³ä¹</h2>
            <div class="options">
                <button class="option-btn" data-music="everywhere we go">â–¶ everywhere we go</button>
                <button class="option-btn" data-music="take me hand">â–¶ take me hand</button>
                <button class="option-btn" data-music="èµ·é£äº†">â–¶ èµ·é£äº†</button>
                <button class="option-btn" data-music="å¤œã€è¤ç«è™«å’Œä½ ">â–¶ å¤œã€è¤ç«è™«å’Œä½ </button>
            </div>
        </div>
    </div>
    
    <!-- è·¨å¹´é‚€è¯·å¼¹çª— -->
    <div id="inviteModal" class="modal hidden">
        <div class="modal-content">
            <h2 id="inviteText">è°¢è°¢ä½ æ„¿æ„é™ªæˆ‘è·¨å¹´</h2>
            <div class="options">
                <button id="reluctantBtn" class="option-btn">â–¶ å¹¶éè‡ªæ„¿</button>
                <button id="willingBtn" class="option-btn">â–¶ è¡Œ</button>
            </div>
        </div>
    </div>
    
    <!-- æ³æ±‚å¼¹çª— -->
    <div id="pleadModal" class="modal hidden">
        <div class="modal-content">
            <h2 id="pleadText">æ±‚æ±‚ä½ äº†é™ªæˆ‘å¥½ä¸å¥½</h2>
            <div class="options">
                <button id="refuseBtn" class="option-btn">â–¶ ä¸è¦</button>
                <button id="agreeBtn" class="option-btn">â–¶ è¡Œå§</button>
            </div>
        </div>
    </div>
    
    <!-- å¤ªå¥½äº†å¼¹çª— -->
    <div id="happyModal" class="modal hidden">
        <div class="modal-content">
            <h2 id="happyText">å¤ªå¥½äº†ï¼ğŸ˜ŠğŸ˜Š</h2>
            <div class="options">
                <button id="continueBtn" class="option-btn">â–¶ ç»§ç»­</button>
            </div>
        </div>
    </div>
    
    <!-- æ‹’ç»5æ¬¡åçš„å¼¹çª— -->
    <div id="rejectModal" class="modal hidden">
        <div class="modal-content">
            <h2 id="rejectText">æ—¢ç„¶ä½ è¿™ä¹ˆä¸æƒ³é™ªæˆ‘ï¼Œé‚£å°±æˆå…¨ä½ å¥½äº†</h2>
            <div class="options">
                <button id="closeBtn" class="option-btn">â–¶ æ»šå§</button>
            </div>
        </div>
    </div>
    
    <!-- éŸ³ä¹æ’­æ”¾å™¨ - éšè— -->
    <!-- éŸ³ä¹æ–‡ä»¶ä½ç½®æ ‡æ³¨ -->
    <!-- è¯·å°†æ‚¨çš„éŸ³ä¹æ–‡ä»¶æ”¾åœ¨ä»¥ä¸‹è·¯å¾„æˆ–æ ¹æ®å®é™…è·¯å¾„ä¿®æ”¹ -->
    <audio id="bgMusic" loop>
        <!-- éŸ³ä¹æ–‡ä»¶è·¯å¾„ç¤ºä¾‹: 
        <source src="music/everywhere-we-go.mp3" type="audio/mpeg">
        <source src="music/take-me-hand.mp3" type="audio/mpeg">
        <source src="music/èµ·é£äº†.mp3" type="audio/mpeg">
        <source src="music/å¤œè¤ç«è™«å’Œä½ .mp3" type="audio/mpeg">
        -->
    </audio>

    <script>
        // éŸ³ä¹é…ç½® - è¯·æ ¹æ®å®é™…æ–‡ä»¶è·¯å¾„ä¿®æ”¹
        const musicFiles = {
            'everywhere we go': 'music/everywhere-we-go.mp3',
            'take me hand': 'music/take-me-hand.mp3',
            'èµ·é£äº†': 'music/èµ·é£äº†.mp3',
            'å¤œã€è¤ç«è™«å’Œä½ ': 'music/å¤œè¤ç«è™«å’Œä½ .mp3'
        };
        
        // è·å–DOMå…ƒç´ 
        const musicModal = document.getElementById('musicModal');
        const inviteModal = document.getElementById('inviteModal');
        const pleadModal = document.getElementById('pleadModal');
        const happyModal = document.getElementById('happyModal');
        const rejectModal = document.getElementById('rejectModal');
        const bgMusic = document.getElementById('bgMusic');
        
        // çŠ¶æ€å˜é‡
        let musicSelected = false;
        let musicTimeout;
        let refuseCount = 0;
        
        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            // è®¾ç½®5ç§’åè‡ªåŠ¨é€‰æ‹©éŸ³ä¹
            musicTimeout = setTimeout(selectRandomMusic, 5000);
            
            // éŸ³ä¹é€‰æ‹©æŒ‰é’®äº‹ä»¶
            document.querySelectorAll('#musicModal .option-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    if (!musicSelected) {
                        musicSelected = true;
                        clearTimeout(musicTimeout);
                        const musicName = this.getAttribute('data-music');
                        playMusic(musicName);
                        showInviteModal();
                    }
                });
            });
            
            // è·¨å¹´é‚€è¯·æŒ‰é’®äº‹ä»¶
            document.getElementById('reluctantBtn').addEventListener('click', function() {
                refuseCount = 0; // é‡ç½®æ‹’ç»è®¡æ•°
                showPleadModal();
            });
            
            document.getElementById('willingBtn').addEventListener('click', function() {
                showHappyModal();
            });
            
            // æ³æ±‚å¼¹çª—æŒ‰é’®äº‹ä»¶
            document.getElementById('refuseBtn').addEventListener('click', function() {
                refuseCount++;
                
                // å¦‚æœæ‹’ç»5æ¬¡ï¼Œæ˜¾ç¤ºæ‹’ç»å¼¹çª—
                if (refuseCount >= 5) {
                    showRejectModal();
                } else {
                    // ä¸éšè—å¼¹çª—ï¼Œåªæ˜¯æ›´æ–°æ–‡å­—å’ŒåŠ¨ç”»
                    const pleadText = document.getElementById('pleadText');
                    pleadText.textContent = '';
                    pleadText.classList.remove('cursor');
                    setTimeout(() => {
                        typewriterEffect(pleadText, 'æ±‚æ±‚ä½ äº†é™ªæˆ‘å¥½ä¸å¥½', 'glow');
                    }, 100);
                }
            });
            
            document.getElementById('agreeBtn').addEventListener('click', function() {
                showHappyModal();
            });
            
            // ç»§ç»­æŒ‰é’®äº‹ä»¶
            document.getElementById('continueBtn').addEventListener('click', function() {
                // è¿™é‡Œå°†è¿›å…¥ä¸‹ä¸€ç•Œé¢
                alert('æ¥ä¸‹æ¥å°†è¿›å…¥ä¸»é¡µé¢');
            });
            
            // å…³é—­æŒ‰é’®äº‹ä»¶
            document.getElementById('closeBtn').addEventListener('click', function() {
                window.close(); // å°è¯•å…³é—­çª—å£
                // å¦‚æœæ— æ³•å…³é—­ï¼Œåˆ™æ˜¾ç¤ºå…³é—­æç¤º
                if (!window.closed) {
                    alert('è¯·æ‰‹åŠ¨å…³é—­æ­¤æ ‡ç­¾é¡µ');
                }
            });
        });
        
        // éšæœºé€‰æ‹©éŸ³ä¹
        function selectRandomMusic() {
            if (!musicSelected) {
                musicSelected = true;
                const musicNames = Object.keys(musicFiles);
                const randomMusic = musicNames[Math.floor(Math.random() * musicNames.length)];
                playMusic(randomMusic);
                showInviteModal();
            }
        }
        
        // æ’­æ”¾éŸ³ä¹å‡½æ•°
        function playMusic(musicName) {
            // æ ¹æ®éŸ³ä¹åç§°è®¾ç½®éŸ³é¢‘æº
            if (musicFiles[musicName]) {
                bgMusic.src = musicFiles[musicName];
                bgMusic.play().catch(e => {
                    console.log('è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢ï¼Œéœ€è¦ç”¨æˆ·äº¤äº’');
                });
            }
        }
        
        // æ˜¾ç¤ºè·¨å¹´é‚€è¯·å¼¹çª—
        function showInviteModal() {
            hideModal(musicModal);
            showModal(inviteModal);
            typewriterEffect(document.getElementById('inviteText'), 'è°¢è°¢ä½ æ„¿æ„é™ªæˆ‘è·¨å¹´', 'rainbow');
        }
        
        // æ˜¾ç¤ºæ³æ±‚å¼¹çª—
        function showPleadModal() {
            hideModal(inviteModal);
            showModal(pleadModal);
            typewriterEffect(document.getElementById('pleadText'), 'æ±‚æ±‚ä½ äº†é™ªæˆ‘å¥½ä¸å¥½', 'glow');
        }
        
        // æ˜¾ç¤ºå¤ªå¥½äº†å¼¹çª—
        function showHappyModal() {
            hideModal(inviteModal);
            hideModal(pleadModal);
            showModal(happyModal);
            typewriterEffect(document.getElementById('happyText'), 'å¤ªå¥½äº†ï¼ğŸ˜ŠğŸ˜Š', 'pulse bounce');
        }
        
        // æ˜¾ç¤ºæ‹’ç»å¼¹çª—
        function showRejectModal() {
            hideModal(pleadModal);
            showModal(rejectModal);
            typewriterEffect(document.getElementById('rejectText'), 'æ—¢ç„¶ä½ è¿™ä¹ˆä¸æƒ³é™ªæˆ‘ï¼Œé‚£å°±æˆå…¨ä½ å¥½äº†', 'glow');
        }
        
        // æ˜¾ç¤ºæ¨¡æ€æ¡†ï¼ˆå¸¦è¿‡æ¸¡æ•ˆæœï¼‰
        function showModal(modal) {
            modal.classList.remove('hidden');
            // å¼ºåˆ¶é‡ç»˜
            modal.offsetHeight;
            modal.style.opacity = "1";
            modal.querySelector('.modal-content').style.transform = "scale(1)";
        }
        
        // éšè—æ¨¡æ€æ¡†ï¼ˆå¸¦è¿‡æ¸¡æ•ˆæœï¼‰
        function hideModal(modal) {
            modal.style.opacity = "0";
            modal.querySelector('.modal-content').style.transform = "scale(0.9)";
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        }
        
        // é€å­—æ˜¾ç¤ºæ•ˆæœå‡½æ•°
        function typewriterEffect(element, text, effectClass = '') {
            element.textContent = '';
            element.classList.add('cursor', 'typewriter');
            
            let i = 0;
            const timer = setInterval(function() {
                if (i < text.length) {
                    element.textContent += text.charAt(i);
                    i++;
                } else {
                    clearInterval(timer);
                    element.classList.remove('cursor');
                    
                    // æ·»åŠ ç‰¹æ®Šæ•ˆæœ
                    if (effectClass) {
                        element.classList.add(...effectClass.split(' '));
                    }
                }
            }, 50); // åŠ å¿«æ–‡å­—æ˜¾ç¤ºé€Ÿåº¦ï¼Œä»100msæ”¹ä¸º50ms
        }
    </script>
</body>
</html>